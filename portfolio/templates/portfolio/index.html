{% extends "portfolio/base.html" %}
{% load static %}

{% block title %}Portfoliology{% endblock %}


{% block extra_head %}

    <style>


        .table {
            margin: 25px 40px 70px 60px;
            width: 90%;
        }

        #dropdown_accounts {
            margin: 0 0 0 60px;
            width: 20%;
            height: 120px
        }

    </style>

{% endblock %}

{% block content %}

    <select multiple="multiple" name="accounts[]" id="dropdown_accounts" class="form-control">
        {% for acct in accounts %}
            <option value="{{ acct }}" class="form-control">{{ acct }}</option>
        {% endfor %}
    </select>

    {{ positions|safe }}

    <script>

        // Handling totals row for sorting purposes
        $(document).ready(function() {

            // Find totals row
            var totalsRow = $(".dataframe td").filter(function() {
                return $(this).text() == "Totals";
            }).closest("tr");

            // Detach totals row and create tfoot element from it
            var totalsRow = totalsRow.detach();
            var totalsHtml = "<tfoot>" + totalsRow.html() + "</tfoot>";

            // Append tfoot to tbody
            $(".dataframe tbody").after(totalsHtml);

        });

        function abbreviateNumber(value) {
            var newValue = value;
            if (value >= 1000) {
                var suffixes = ["", "k", "m", "b","t"];
                var suffixNum = Math.floor( (""+value).length/3 );
                var shortValue = '';
                for (var precision = 2; precision >= 1; precision--) {
                    shortValue = parseFloat( (suffixNum != 0 ? (value / Math.pow(1000,suffixNum) ) : value).toPrecision(precision));
                    var dotLessShortValue = (shortValue + '').replace(/[^a-zA-Z 0-9]+/g,'');
                    if (dotLessShortValue.length <= 2) { break; }
                }
                if (shortValue % 1 != 0)  shortNum = shortValue.toFixed(1);
                newValue = shortValue+suffixes[suffixNum];
            }
            return newValue;
        }
    </script>

{% endblock %}
